events {}

http {
  map $http_x_request_id $reqid {
    "" $request_id;
    default $http_x_request_id;
  }

  log_format main '$remote_addr - $reqid [$time_local] "$request" $status $body_bytes_sent "$http_referer" "$http_user_agent"';
  access_log /var/log/nginx/access.log main;
  error_log /var/log/nginx/error.log warn;

  server {
    listen 80;

    location / {
      add_header X-Request-ID $reqid;
      proxy_set_header X-Request-ID $reqid;
      proxy_pass http://tomcat:8080/;
    }
  }
}
